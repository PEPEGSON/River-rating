<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>River Rating</title>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@500;600;700&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

<style>
:root{
  --bg:#0b0c0f;
  --panel:rgba(18,20,26,.75);
  --stroke:rgba(255,255,255,.10);
  --text:rgba(255,255,255,.92);
  --gold:#d6b56a;
}

*{box-sizing:border-box}
body{
  margin:0;
  font-family:Inter, sans-serif;
  background:#0b0c0f;
  color:var(--text);
  overflow-x:hidden;
}

body::before{
  content:"";
  position:fixed;
  inset:0;
  background:url("./assets/bg.png") center/cover no-repeat;
  z-index:-2;
}

.wrap{
  width:min(1300px,95vw);
  margin:30px auto;
}

.panel{
  background:var(--panel);
  border-radius:18px;
  border:1px solid var(--stroke);
  overflow:hidden;
}

.wide-wrap{
  overflow-x:auto;
  -webkit-overflow-scrolling:touch;
}

table{
  border-collapse:collapse;
  min-width:max-content;
  width:100%;
}

thead th{
  padding:12px;
  font-size:12px;
  letter-spacing:.05em;
  text-transform:uppercase;
  background:rgba(0,0,0,.5);
}

tbody td{
  padding:12px;
  text-align:center;
}

tbody tr{
  transition:.2s;
  position:relative;
  overflow:hidden;
}

tbody tr:nth-child(even){
  background:rgba(255,255,255,.03);
}

/* ===== ELEMENT TEXTURE LITE ===== */

tbody tr.rank-fire::before,
tbody tr.rank-earth::before,
tbody tr.rank-air::before,
tbody tr.rank-water::before{
  content:"";
  position:absolute;
  inset:-30px;
  opacity:.55;
  filter:blur(12px);
  animation:drift 8s ease-in-out infinite;
  z-index:0;
}

tbody tr > td{
  position:relative;
  z-index:1;
}

/* FIRE */
tbody tr.rank-fire::before{
  background:
  radial-gradient(circle at 30% 60%, rgba(255,140,0,.4), transparent 70%),
  radial-gradient(circle at 70% 40%, rgba(255,60,0,.4), transparent 70%);
}

/* EARTH */
tbody tr.rank-earth::before{
  background:
  radial-gradient(circle at 40% 50%, rgba(160,110,40,.35), transparent 70%),
  radial-gradient(circle at 70% 60%, rgba(100,60,20,.35), transparent 70%);
}

/* AIR */
tbody tr.rank-air::before{
  background:
  radial-gradient(circle at 50% 50%, rgba(200,230,255,.3), transparent 70%),
  radial-gradient(circle at 80% 30%, rgba(150,200,255,.25), transparent 70%);
}

/* WATER */
tbody tr.rank-water::before{
  background:
  radial-gradient(circle at 30% 50%, rgba(0,150,255,.35), transparent 70%),
  radial-gradient(circle at 70% 40%, rgba(0,90,200,.3), transparent 70%);
}

@keyframes drift{
  0%{transform:translateX(-1%)}
  50%{transform:translateX(1%)}
  100%{transform:translateX(-1%)}
}

/* MEDAL NUMBERS */
.place-gold{color:#ffd700;font-weight:700}
.place-silver{color:#c0c0c0;font-weight:700}
.place-bronze{color:#cd7f32;font-weight:700}

</style>
</head>
<body>

<div class="wrap">
<div class="panel">
<div class="wide-wrap">
<table id="leaderboard"></table>
</div>
</div>
</div>

<script>
const SHEET_ID="1Pj2H4dT3f0W7rmWQPPgj1_FHbCPSIDsRmO56I-VmZls";
const LEADERBOARD_URL=`https://opensheet.elk.sh/${SHEET_ID}/Leaderboard`;

function toNum(v){
  const n=Number(String(v||"").replace(",","."));
  return isFinite(n)?n:0;
}

async function render(){
  const res=await fetch(LEADERBOARD_URL);
  const rowsRaw=await res.json();

  const rows=[...rowsRaw].sort((a,b)=>toNum(b.season_score)-toNum(a.season_score));

  let head=`<thead><tr>
  <th>№</th><th>Игрок</th><th>Очки сезона</th><th>Total</th>
  </tr></thead>`;

  let body="<tbody>";
  rows.forEach((r,i)=>{
    const n=i+1;
    let cls="";
    if(n<=3)cls="rank-fire";
    else if(n<=6)cls="rank-earth";
    else if(n<=10)cls="rank-air";
    else if(n<=13)cls="rank-water";

    let medal="";
    if(n===1)medal="place-gold";
    if(n===2)medal="place-silver";
    if(n===3)medal="place-bronze";

    body+=`
    <tr class="${cls}">
      <td class="${medal}">${n}</td>
      <td>${r.name||""}</td>
      <td>${r.season_score||0}</td>
      <td>${r.all_seasons_score||0}</td>
    </tr>`;
  });
  body+="</tbody>";

  document.getElementById("leaderboard").innerHTML=head+body;
}

render();
</script>

</body>
</html>
